import { DeviceModel } from './DeviceModel'; // ç¡®ä¿è·¯å¾„æ­£ç¡®

/**
 * æ™ºèƒ½æ‘„åƒå¤´è®¾å¤‡æ¨¡å‹
 */
export class CameraDevice extends DeviceModel {
  // æ‘„åƒå¤´ç‰¹æœ‰å±æ€§
  isRecording: boolean = false; // æ˜¯å¦æ­£åœ¨å½•åƒ
  privacyMode: boolean = true;  // éšç§æ¨¡å¼ï¼ˆå¿«é—¨æ˜¯å¦å…³é—­ï¼‰
  motionDetected: boolean = false; // æ˜¯å¦æ£€æµ‹åˆ°ç§»åŠ¨

  // æ„é€ å‡½æ•°
  constructor(id: string, name: string) {
    // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œç±»å‹è®¾ç½®ä¸º 'camera'
    super(id, name, 'camera');
    this.status = 'off'; // é»˜è®¤å…³é—­ï¼ŒèŠ‚çœèµ„æº
    this.isRecording = false;
  }

  // å¼€å¯/å…³é—­å½•åƒ
  toggleRecording(): void {
    if (this.status === 'on' && !this.privacyMode) {
      this.isRecording = !this.isRecording;
    } else {
      // æç¤ºï¼šå¿…é¡»å…ˆå¼€å¯æ‘„åƒå¤´ä¸”å…³é—­éšç§æ¨¡å¼
      console.warn("æ— æ³•å¼€å§‹å½•åƒï¼šæ‘„åƒå¤´æœªå¼€å¯æˆ–å¤„äºéšç§æ¨¡å¼ã€‚");
      this.isRecording = false;
    }
  }

  // åˆ‡æ¢éšç§æ¨¡å¼
  togglePrivacyMode(): void {
    this.privacyMode = !this.privacyMode;
    // å¦‚æœå¼€å¯äº†éšç§æ¨¡å¼ï¼Œåˆ™å¼ºåˆ¶å…³é—­å½•åƒå’ŒçŠ¶æ€
    if (this.privacyMode) {
      this.isRecording = false;
      this.status = 'off';
    }
  }

  // æ¨¡æ‹Ÿä¾¦æµ‹åˆ°ç§»åŠ¨
  triggerMotionAlert(): void {
    if (this.status === 'on' && !this.privacyMode) {
      this.motionDetected = true;
      console.log('ğŸš¨ ç§»åŠ¨ä¾¦æµ‹è­¦æŠ¥ï¼');
      setTimeout(() => {
        this.motionDetected = false;
      }, 5000); // 5ç§’åè­¦æŠ¥è§£é™¤
    }
  }

  // é‡å†™çˆ¶ç±»çš„ toggleStatus æ–¹æ³•
  toggleStatus(): void {
    if (this.privacyMode) {
      // å¦‚æœå¤„äºéšç§æ¨¡å¼ï¼Œä¸å…è®¸å¼€å¯ï¼Œå¿…é¡»å…ˆå…³é—­éšç§æ¨¡å¼
      console.warn("è¯·å…ˆå…³é—­éšç§æ¨¡å¼æ‰èƒ½å¼€å¯æ‘„åƒå¤´ã€‚");
      this.status = 'off';
    } else {
      // æ­£å¸¸åˆ‡æ¢çŠ¶æ€
      this.status = this.status === 'on' ? 'off' : 'on';
      // å¦‚æœå…³é—­ï¼Œåˆ™åœæ­¢å½•åƒ
      if (this.status === 'off') {
        this.isRecording = false;
      }
    }
  }
}